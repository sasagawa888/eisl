(defmacro test (form1 form2 :rest pred)
    (if (null pred)
        `(if
          (equal ,form1 ',form2)
          (format (standard-output) "" ',form1)
          (format (standard-output) "~S is bad~%" ',form1))
        `(if
          (,@pred ,form1 ',form2)
          (format (standard-output) "" ',form1)
          (format (standard-output) "~S is bad~%" ',form1))))


(import "list")
T
(test (caar '((a b) (c d) (e f))) A)
(test (cadr '((a b) (c d) (e f)))
 (C D))
(test (cdar '((a b) (c d) (e f)))
(B))
(test (cddr '((a b) (c d) (e f)))
((E F)))
(test (first '(a b c d e f))
A)
(test (second '(a b c d e f))
B)
(test (third '(a b c d e f))
C)
(test (fourth '(a b c d e f))
D)
(test (fifth '(a b c d e f))
E)
(test (last-pair '(a b c d e f))
(F))
(test (last '(a b c d e f))
F)
(test (take '(a b c d e f) 3)
(A B C))
(test (drop '(a b c d e f) 3)
(D E F))
(test (take '(a b c d e f) 7)
(A B C D E F))
(test (drop '(a b c d e f) 7)
NIL)
(test (append-reverse '(a b c) '(d e f))
(C B A D E F))
(test (append-reverse nil '(d e f))
(D E F))
(test (append-reverse '(a b c) nil)
(C B A))
(test (iota 1 10)
(1 2 3 4 5 6 7 8 9 10))
(test (iota 1 1)
(1))
(test (iota 1 0)
NIL)
(test (remove-duplicate '(a b c a b c d a b c d e))
(A B C D E))
(test (remove-duplicate '(a b c d e f))
(A B C D E F))
(defun evenp (x) (= (mod x 2) 0))

(test (remove-if #'evenp '(1 2 3 4 5 6 7 8 9 10))
(1 3 5 7 9))
(test (remove 'a '(a b c a b c d a b c d e))
(B C B C D B C D E))
(test (fold-left #'+ 0 '(1 2 3 4 5 6 7 8 9 10))
55)
(test (fold-left #'cons nil '(a b c d e f))
((((((NIL . A) . B) . C) . D) . E) . F))
(defun xcons (a b) (cons b a))

(test (fold-left #'xcons nil '(a b c d e f))
(F E D C B A))
(test (fold-right #'+ 0 '(1 2 3 4 5 6 7 8 9 10))
55)
(test (fold-right #'cons nil '(a b c d e f))
(A B C D E F))
(test (partition #'evenp '(1 2 3 4 5 6 7 8 9 10))
((2 4 6 8 10) 1 3 5 7 9))
(test (partition (lambda (x) (< x 5)) '(1 2 3 4 5 6 7 8 9 10))
((1 2 3 4) 5 6 7 8 9 10))
(test (find-if #'evenp '(1 2 3 5 7 9)
)
2)
(test (find-if #'evenp '(1 3 5 7 9 4))
4)
(test (find-if #'evenp '(1 3 5 7 9))
NIL)
(test (find 'a '(a b c d e))
A)
(test (find 'e '(a b c d e))
E)
(test (find 'f '(a b c d e))
NIL)
(test (position-if #'evenp '(2 1 3 5 7 9))
0)
(test (position-if #'evenp '(1 3 5 7 9 2))
5)
(test (position-if #'evenp '(1 3 5 7 9))
-1)
(test (position 'a '(a b c d e))
0)
(test (position 'e '(a b c d e))
4)
(test (position 'f '(a b c d e))
-1)
(test (count-if #'evenp '(1 2 3 4 5 6 7 8 9))
4)
(test (count-if #'evenp '(1 3 5 7 9))
0)
(test (count 'a '(a b a b c a b c d))
3)
(test (count 'd '(a b a b c a b c d))
1)
(test (count 'e '(a b a b c a b c d))
0)
(test (any #'< '(1 3 5) '(2 1 0))
T)
(test (any #'< '(1 3 5) '(0 1 0))
NIL)
(test (every #'< '(1 3 5) '(2 4 6))
T)
(test (every #'< '(1 3 5) '(2 4 0))
NIL)
(test (any #'evenp '(1 3 4 5))
T)
(test (any #'evenp '(1 3 5))
NIL)
(test (every #'evenp '(1 2 3 4 5))
NIL)
(test (every #'evenp '(2 4 6 8))
T)
(test (union '(1 2 3 4) '(3 4 5 6))
(1 2 3 4 5 6))
(test (intersection '(1 2 3 4) '(3 4 5 6))
(3 4))
(test (difference '(1 2 3 4) '(3 4 5 6))
(1 2))
(test (subsetp '(1 2) '(1 2 3 4))
T)
(test (subsetp '(1 2 5) '(1 2 3 4))
NIL)

(format (standard-output) "ALl tests are done!~%")